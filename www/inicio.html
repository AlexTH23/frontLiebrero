<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liebrero - Tu Biblioteca Digital</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Variables CSS */
        :root {
            --primary: #8B4513;
            --primary-dark: #5d2e0b;
            --primary-light: #a05a2c;
            --secondary: #5d4037;
            --light-bg: #f5f1e8;
            --dark-bg: #1a1a1a;
            --text-light: #e0e0e0;
            --text-dark: #3a2c1e;
            --white: #ffffff;
            --gray-light: #d7ccc8;
            --accent: #8B0000;
            --accent-hover: #A52A2A;
            --accent-light: #b14545;
            --accent-dark: #5a0000;
            --transition: all 0.3s ease;
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.15);
            --border-radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .dark-mode {
            background-color: var(--dark-bg);
            color: var(--text-light);
        }

        /* Navbar superior */
        .top-navbar {
            background-color: var(--primary);
            color: var(--white);
            padding: 14px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        .top-navbar .back-btn {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.1rem;
            cursor: pointer;
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .top-navbar .back-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: scale(1.05);
        }

        .top-navbar .title {
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
            flex: 1;
            letter-spacing: 0.5px;
        }

        .top-navbar .search-btn {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.1rem;
            cursor: pointer;
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .top-navbar .search-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: scale(1.05);
        }

        .navbar-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        /* Buscador */
        .search-container {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: var(--primary);
            padding: 14px 16px;
            z-index: 200;
            display: none;
            box-shadow: var(--shadow-sm);
            animation: slideDown 0.3s ease forwards;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        .search-box {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            padding: 8px 14px;
            transition: var(--transition);
        }

        .search-box input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 0.95rem;
            padding: 5px 10px;
            background: transparent;
            color: var(--white);
        }

        .search-box input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-box .close-btn {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.1rem;
            cursor: pointer;
            margin-left: 8px;
            transition: var(--transition);
        }

        .search-box .close-btn:hover {
            transform: rotate(90deg);
        }

        /* Contenido principal */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px 16px 80px;
            display: flex;
            flex-direction: column;
            gap: 25px;
            transition: var(--transition);
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--secondary);
            padding-left: 12px;
            position: relative;
        }

        .section-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--accent);
            border-radius: 2px;
        }

        .book-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            gap: 16px;
        }

        .book-item {
            background: var(--white);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: var(--transition);
            height: 170px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .dark-mode .book-item {
            background-color: #2d2d2d;
        }

        .book-item:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }

        .book-cover {
            flex: 1;
            background: linear-gradient(135deg, #d7ccc8, #bcaaa4);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .dark-mode .book-cover {
            background: linear-gradient(135deg, #444, #333);
        }

        .book-cover span {
            font-weight: 600;
            font-size: 1.3rem;
            color: var(--text-dark);
            z-index: 2;
        }

        .dark-mode .book-cover span {
            color: var(--text-light);
        }

        .book-cover::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 15px;
            background: rgba(0, 0, 0, 0.05);
        }

        .book-title {
            padding: 10px 8px;
            font-size: 0.75rem;
            text-align: center;
            background: var(--white);
            font-weight: 500;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            line-height: 1.3;
        }

        .dark-mode .book-title {
            background: #333;
            color: var(--text-light);
        }

        .divider {
            height: 1px;
            background-color: var(--gray-light);
            margin: 12px 0;
        }

        .dark-mode .divider {
            background-color: #444;
        }

        /* Vista de libro */
        .book-detail {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--light-bg);
            z-index: 300;
            padding: 18px;
            overflow-y: auto;
            transform: translateY(100%);
            transition: transform 0.4s ease;
            display: flex;
            flex-direction: column;
        }

        .dark-mode .book-detail {
            background: var(--dark-bg);
        }

        .book-detail.active {
            transform: translateY(0);
        }

        .book-header {
            display: flex;
            margin-bottom: 20px;
            flex-direction: column;
            align-items: center;
        }

        .book-cover-large {
            width: 110px;
            height: 160px;
            background: linear-gradient(135deg, #d7ccc8, #bcaaa4);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-md);
            margin-bottom: 18px;
        }

        .dark-mode .book-cover-large {
            background: linear-gradient(135deg, #444, #333);
        }

        .book-cover-large span {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .dark-mode .book-cover-large span {
            color: var(--text-light);
        }

        .book-info {
            flex: 1;
        }

        .book-title-large {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--secondary);
            text-align: center;
        }

        .dark-mode .book-title-large {
            color: #e0e0e0;
        }

        .book-author {
            font-size: 0.95rem;
            color: var(--primary-light);
            margin-bottom: 15px;
            text-align: center;
            font-weight: 500;
        }

        .book-description {
            font-size: 0.9rem;
            line-height: 1.5;
            color: var(--text-dark);
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(139, 69, 19, 0.05);
            border-radius: var(--border-radius);
        }

        .dark-mode .book-description {
            color: #e0e0e0;
            background: rgba(139, 69, 19, 0.1);
        }

        .read-btn {
            background: var(--accent);
            color: var(--white);
            border: none;
            padding: 12px 20px;
            border-radius: 24px;
            font-size: 0.95rem;
            cursor: pointer;
            display: block;
            width: 100%;
            max-width: 280px;
            margin: 0 auto;
            transition: var(--transition);
            font-weight: 500;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .read-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
        }

        .read-btn:active {
            transform: translateY(1px);
        }

        /* Navbar inferior */
        .bottom-navbar {
            background-color: var(--primary);
            color: var(--white);
            padding: 10px 8px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
            padding: 6px 8px;
            border-radius: 8px;
            flex: 1;
            max-width: 60px;
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.15);
        }

        .nav-item i {
            font-size: 1.2rem;
            margin-bottom: 4px;
            transition: var(--transition);
        }

        .nav-item.active i {
            transform: scale(1.1);
        }

        .nav-item span {
            font-size: 0.65rem;
            font-weight: 500;
            transition: var(--transition);
        }

        .user-icon {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 500;
            font-size: 0.9rem;
        }

        /* Efecto de libro */
        .book-spine {
            position: absolute;
            left: 5px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: rgba(0, 0, 0, 0.1);
        }

        /* Resultados de búsqueda */
        .search-results {
            display: none;
            padding: 15px;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            margin-top: 12px;
            animation: fadeIn 0.3s ease;
        }

        .dark-mode .search-results {
            background: #2d2d2d;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-results h3 {
            margin-bottom: 10px;
            color: var(--secondary);
            font-size: 0.95rem;
        }

        .dark-mode .search-results h3 {
            color: #e0e0e0;
        }

        .result-item {
            padding: 10px;
            border-bottom: 1px solid var(--gray-light);
            cursor: pointer;
            transition: var(--transition);
            border-radius: 6px;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .dark-mode .result-item {
            border-bottom: 1px solid #444;
        }

        .result-item:hover {
            background: rgba(139, 69, 19, 0.08);
        }

        .dark-mode .result-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .result-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        /* Animaciones al cargar */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            animation: fadeInUp 0.4s ease forwards;
            opacity: 0;
        }

        .section:nth-child(1) { animation-delay: 0.1s; }
        .section:nth-child(2) { animation-delay: 0.2s; }

        .book-item {
            animation: fadeIn 0.3s ease forwards;
            opacity: 0;
            animation-delay: calc(0.1s * var(--i));
        }

        /* Mensajes de carga y error */
        .loading-section {
            text-align: center;
            padding: 25px 0;
            color: var(--primary);
            font-weight: 500;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
        }

        .dark-mode .loading-section {
            color: var(--accent-light);
        }

        .loading-spinner {
            width: 32px;
            height: 32px;
            border: 3px solid rgba(139, 69, 19, 0.2);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .dark-mode .loading-spinner {
            border: 3px solid rgba(139, 69, 19, 0.2);
            border-top: 3px solid var(--accent-light);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-section {
            text-align: center;
            padding: 25px 0;
            color: var(--accent);
            font-weight: 500;
            font-size: 0.95rem;
        }

        .dark-mode .error-section {
            color: var(--accent-light);
        }
        
        /* Botón de retroceso en detalle */
        #detailBackBtn {
            position: absolute;
            top: 15px;
            left: 15px;
            z-index: 10;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body>
    <!-- Navbar Superior -->
    <div class="top-navbar">
        <button class="back-btn" id="backBtn"><i class="fas fa-arrow-left"></i></button>
        <div class="title">INICIO</div>
        <div class="navbar-actions">
            <button class="search-btn" id="searchBtn"><i class="fas fa-search"></i></button>
        </div>
    </div>
    
    <!-- Buscador -->
    <div class="search-container" id="searchContainer">
        <div class="search-box">
            <i class="fas fa-search" style="color: var(--white);"></i>
            <input type="text" id="searchInput" placeholder="Buscar libros...">
            <button class="close-btn" id="closeSearch"><i class="fas fa-times"></i></button>
        </div>
        <div class="search-results" id="searchResults">
            <h3>Resultados de búsqueda:</h3>
            <div class="result-item" data-book="hp">Harry Potter y la piedra filosofal</div>
            <div class="result-item" data-book="salem">LOS JUICIOS DE SALEM</div>
            <div class="result-item" data-book="bosque">El Bosque Mágico</div>
        </div>
    </div>
    
    <!-- Contenido Principal -->
    <div class="main-content" id="mainContent">
        <!-- Sección: FIERTO PORTER Y EL PASEO FÍSICOES -->
        <div class="section">
            <h2 class="section-title">FIERTO PORTER Y EL PASEO FÍSICOES</h2>
            <div class="book-list" id="section1">
                <div class="loading-section">
                    <div class="loading-spinner"></div>
                    <div>Cargando libros...</div>
                </div>
            </div>
        </div>
        
        <div class="divider"></div>
        
        <!-- Sección: CADA HISTORIA CUENTA -->
        <div class="section">
            <h2 class="section-title">CADA HISTORIA CUENTA</h2>
            <div class="book-list" id="section2">
                <div class="loading-section">
                    <div class="loading-spinner"></div>
                    <div>Cargando libros...</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Vista de Detalle de Libro -->
    <div class="book-detail" id="bookDetail">
        <button class="back-btn" id="detailBackBtn"><i class="fas fa-arrow-left"></i></button>
        <div class="book-header">
            <div class="book-cover-large">
                <span id="bookInitial">HP</span>
            </div>
            <div class="book-info">
                <h1 class="book-title-large" id="detailTitle">Harry Potter y la piedra filosofal</h1>
                <div class="book-author" id="detailAuthor">J.K. Rowling</div>
                <div class="book-description" id="detailDescription">
                    Harry Potter y la piedra filosofal es el primer libro de la serie literaria Harry Potter, escrito por la autora británica J.K. Rowling. Sigue la historia de Harry Potter, un niño que descubre en su undécimo cumpleaños que es un mago. Harry es invitado a asistir al Colegio Hogwarts de Magia y Hechicería, donde comienza a entrenar como mago.
                </div>
                <button class="read-btn">Leer ahora</button>
            </div>
        </div>
    </div>
    
<!-- Navbar Inferior -->
<div class="bottom-navbar">
    <div class="nav-item active" id="navHome" onclick="location.href='inicio.html'">
        <i class="fas fa-home"></i>
        <span>Inicio</span>
    </div>
    <div class="nav-item" id="navSearch" onclick="document.getElementById('searchBtn').click()">
        <i class="fas fa-search"></i>
        <span>Buscar</span>
    </div>
    <div class="nav-item" id="navCreate" onclick="location.href='publicarlibro.html'">
        <i class="fas fa-plus-circle"></i>
        <span>Crear</span>
    </div>
    <div class="nav-item" id="navProfile" onclick="location.href='cuenta.html'">
        <div class="user-icon">U</div>
        <span>Perfil</span>
    </div>
    <div class="nav-item" id="navConfig" onclick="location.href='configuracion.html'">
        <i class="fas fa-cog"></i>
        <span>Config</span>
    </div>
</div>

    <script>
        // Elementos DOM
        const searchBtn = document.getElementById('searchBtn');
        const closeSearch = document.getElementById('closeSearch');
        const searchContainer = document.getElementById('searchContainer');
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        const bookDetail = document.getElementById('bookDetail');
        const detailBackBtn = document.getElementById('detailBackBtn');
        const navSearch = document.getElementById('navSearch');
        const mainContent = document.getElementById('mainContent');
        const backBtn = document.getElementById('backBtn');

        // Configuración de la API
        const CORS_PROXY = 'https://corsproxy.io/?';
        const API_BASE_URL = 'https://liebrero-st86n.ondigitalocean.app/libros';
        const FULL_API_URL = CORS_PROXY + encodeURIComponent(API_BASE_URL);

        // Almacén de libros
        let books = {};

        // Función para obtener iniciales del título
        function getInitials(title) {
            const words = title.split(' ');
            let initials = '';
            for (let i = 0; i < words.length; i++) {
                if (words[i].length > 0) {
                    initials += words[i][0];
                    if (initials.length >= 2) break;
                }
            }
            return initials.substring(0, 2).toUpperCase();
        }

        // Función para obtener libros de la API
        async function fetchBooks() {
            try {
                const response = await fetch(FULL_API_URL);
                if (!response.ok) throw new Error('Error al cargar libros');
                const data = await response.json();
                
                // Procesar respuesta
                let libros = [];
                if (Array.isArray(data)) {
                    libros = data;
                } else if (data.libros) {
                    libros = data.libros;
                } else if (data.books) {
                    libros = data.books;
                }
                
                // Organizar en secciones (primera mitad en sección 1, segunda en sección 2)
                const half = Math.ceil(libros.length / 2);
                const section1 = libros.slice(0, half);
                const section2 = libros.slice(half);
                
                // Crear elementos DOM para los libros
                renderBooks(section1, 'section1');
                renderBooks(section2, 'section2');
                
                // Almacenar libros en objeto global
                libros.forEach(libro => {
                    books[libro.id] = {
                        title: libro.titulo,
                        author: libro.autor,
                        description: libro.descripcion,
                        initial: getInitials(libro.titulo)
                    };
                });
                
            } catch (error) {
                console.error('Error fetching books:', error);
                // Mostrar mensaje de error
                document.getElementById('section1').innerHTML = '<div class="error-section">Error cargando libros</div>';
                document.getElementById('section2').innerHTML = '';
            }
        }

        // Función para renderizar libros
        function renderBooks(libros, sectionId) {
            const section = document.getElementById(sectionId);
            if (!section) return;
            
            section.innerHTML = '';
            
            libros.forEach((libro, index) => {
                const bookElement = document.createElement('div');
                bookElement.className = 'book-item';
                bookElement.setAttribute('data-book', libro.id);
                bookElement.style.setProperty('--i', index + 1);
                
                bookElement.innerHTML = `
                    <div class="book-cover">
                        <div class="book-spine"></div>
                        <span>${getInitials(libro.titulo)}</span>
                    </div>
                    <div class="book-title">${libro.titulo}</div>
                `;
                
                section.appendChild(bookElement);
                
                // Agregar evento clic
                bookElement.addEventListener('click', function() {
                    showBookDetail(libro.id);
                });
            });
        }

        // Mostrar detalle de libro
        function showBookDetail(bookId) {
            const book = books[bookId];
            if (book) {
                document.getElementById('detailTitle').textContent = book.title;
                document.getElementById('detailAuthor').textContent = book.author;
                document.getElementById('detailDescription').textContent = book.description;
                document.getElementById('bookInitial').textContent = book.initial;
                bookDetail.classList.add('active');
                // Atenuar y deshabilitar el contenido principal
                mainContent.style.opacity = '0.3';
                mainContent.style.pointerEvents = 'none';
            }
        }

        // Ocultar detalle de libro
        function hideBookDetail() {
            bookDetail.classList.remove('active');
            // Restaurar el contenido principal
            mainContent.style.opacity = '1';
            mainContent.style.pointerEvents = 'all';
        }

        // Mostrar buscador
        function showSearch() {
            searchContainer.style.display = 'block';
            mainContent.style.opacity = '0.3';
            mainContent.style.pointerEvents = 'none';
            searchInput.focus();
        }

        // Ocultar buscador
        function hideSearch() {
            searchContainer.style.display = 'none';
            mainContent.style.opacity = '1';
            mainContent.style.pointerEvents = 'all';
            searchInput.value = '';
            searchResults.style.display = 'none';
        }

        // Event Listeners
        searchBtn.addEventListener('click', showSearch);
        navSearch.addEventListener('click', showSearch);
        closeSearch.addEventListener('click', hideSearch);
        detailBackBtn.addEventListener('click', hideBookDetail);
        backBtn.addEventListener('click', function() {
            // Si el detalle está visible, lo ocultamos
            if (bookDetail.classList.contains('active')) {
                hideBookDetail();
            } 
            // Si el buscador está visible, lo ocultamos
            else if (searchContainer.style.display === 'block') {
                hideSearch();
            }
        });

        // Buscar libros al escribir
        searchInput.addEventListener('input', function() {
            if (this.value.length > 0) {
                searchResults.style.display = 'block';
                
                // Filtrar libros
                const searchTerm = this.value.toLowerCase();
                let resultsHTML = '<h3>Resultados de búsqueda:</h3>';
                let resultsCount = 0;
                
                for (const id in books) {
                    const book = books[id];
                    if (book.title.toLowerCase().includes(searchTerm)) {
                        resultsHTML += `<div class="result-item" data-book="${id}">${book.title}</div>`;
                        resultsCount++;
                    }
                }
                
                if (resultsCount === 0) {
                    resultsHTML += '<p>No se encontraron resultados</p>';
                }
                
                searchResults.innerHTML = resultsHTML;
                
                // Agregar eventos a los resultados
                document.querySelectorAll('.result-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const bookId = this.getAttribute('data-book');
                        hideSearch();
                        showBookDetail(bookId);
                    });
                });
                
            } else {
                searchResults.style.display = 'none';
            }
        });

        // Navegación inferior
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                // Remover clase activa de todos
                document.querySelectorAll('.nav-item').forEach(el => {
                    el.classList.remove('active');
                });
                
                // Agregar clase activa al seleccionado
                this.classList.add('active');
            });
        });

        // Iniciar carga de libros
        document.addEventListener('DOMContentLoaded', fetchBooks);
    </script>
</body>
</html>